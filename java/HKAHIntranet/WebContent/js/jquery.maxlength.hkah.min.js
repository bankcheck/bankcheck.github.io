(function($){$.fn.maxlength=function(options){var settings=jQuery.extend({events:[],maxCharacters:10,status:true,statusClass:"status",statusText:"character left",notificationClass:"input-maxlength-reached",showAlert:false,alertText:"You have typed too many characters.",slider:true,nonAsciiCharLength:2},options);$.merge(settings.events,['keyup']);return this.each(function(){var item=$(this);var charactersLength=unicodeLength($(this).val());function updateStatus(){var charactersLeft=settings.maxCharacters-charactersLength;if(charactersLeft<0){charactersLeft=0}item.next("div").html(charactersLeft+" "+settings.statusText)}function checkChars(){var valid=true;if(charactersLength>=settings.maxCharacters){valid=false;item.addClass(settings.notificationClass);var itemLength=item.val().length;var itemunicodeLength=unicodeLength(item.val());var diff=itemunicodeLength-itemLength;var maxLength=settings.maxCharacters;item.val(item.val().substr(0,maxLength-diff));showAlert()}else{if(item.hasClass(settings.notificationClass)){item.removeClass(settings.notificationClass)}}if(settings.status){updateStatus()}}function showAlert(){if(settings.showAlert){alert(settings.alertText)}}function validateElement(){var ret=false;if(item.is('textarea')){ret=true}else if(item.filter("input[type=text]")){ret=true}else if(item.filter("input[type=password]")){ret=true}return ret}function unicodeLength(str){var l=0;for(var i=0;i<str.length;i++){if(str.charCodeAt(i)>=127)l=l+settings.nonAsciiCharLength;else l=l+1}return l}if(!validateElement()){return false}$.each(settings.events,function(i,n){item.bind(n,function(e){charactersLength=unicodeLength(item.val());checkChars()})});if(settings.status){item.after($("<div/>").addClass(settings.statusClass).html('-'));updateStatus()}if(!settings.status){var removeThisDiv=item.next("div."+settings.statusClass);if(removeThisDiv){removeThisDiv.remove()}}if(settings.slider){item.next().hide();item.focus(function(){item.next().slideDown('fast')});item.blur(function(){item.next().slideUp('fast')})}})}})(jQuery);