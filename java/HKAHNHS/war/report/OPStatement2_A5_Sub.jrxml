<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="OPStatement_Sub" pageWidth="555" pageHeight="381" orientation="Landscape" whenNoDataType="AllSectionsNoDetail" columnWidth="555" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0">
	<property name="ireport.zoom" value="1.6105100000000028"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="Date" class="java.lang.String"/>
	<parameter name="Item" class="java.lang.String"/>
	<parameter name="Amount" class="java.lang.String"/>
	<parameter name="3LINESNOTE" class="java.lang.String"/>
	<parameter name="ALINENOTES" class="java.lang.String"/>
	<queryString>
		<![CDATA[SELECT TO_CHAR(ST.STNTDATE,'DD/MM/YYYY') STNTDATE,
           ST.STNBAMT AS AMOUNT,
           DECODE(ST.STNRLVL,
                  1,
                  DPS.DSCDESC||'  '||DPS.DSCCDESC,
                  2,
                  DP.DPTNAME||'  '||DP.DPTCNAME,
                  3,
                  ST.STNDESC || ' ' || ST.STNDESC1,
                  4,
                  PK.PKGNAME||CPK.PKGNAME||' '||PK.PKGCNAME||CPK.PKGCNAME,
                  5,
                  PK.PKGNAME||CPK.PKGNAME||' '||PK.PKGCNAME||CPK.PKGCNAME,
                  6,
                  DPS.DSCDESC||' '||ST.STNDESC||'  '||DPS.DSCCDESC||' '||ST.STNDESC1,
                  7,
                  PK.PKGNAME||CPK.PKGNAME||' '||PK.PKGCNAME||CPK.PKGCNAME,
                  NULL) DESCRIPTION,
           ST.UNIT AS QTY,
           DECODE(ST.STNRLVL,4,NULL,7,NULL,ST.DSCCODE) AS DSCCODE,
           DECODE(ST.STNTYPE,'D','A','I','A','O','A','X','A','B') AS ITMFLAG
      FROM SLIPTX ST, DPSERV DPS, DEPT DP, PACKAGE PK,CREDITPKG CPK
     WHERE ST.DSCCODE = DPS.DSCCODE(+)
       AND SUBSTR(ST.GLCCODE, 1, 4) = DP.DPTCODE(+)
       AND ST.PKGCODE = PK.PKGCODE(+)
       AND ST.PKGCODE = CPK.PKGCODE(+)
       AND ST.STNSTS IN ('N', 'A')
       AND ST.SLPNO ='20092760007']]>
	</queryString>
	<field name="STNTDATE" class="java.lang.String"/>
	<field name="AMOUNT" class="java.math.BigDecimal"/>
	<field name="DESCRIPTION" class="java.lang.String"/>
	<field name="QTY" class="java.math.BigDecimal"/>
	<field name="ITMFLAG" class="java.lang.String"/>
	<field name="CDESCCODE" class="java.lang.String"/>
	<variable name="TOTAL" class="java.math.BigDecimal" resetType="Group" resetGroup="ITMFLAG" calculation="Sum">
		<variableExpression><![CDATA[$F{AMOUNT}]]></variableExpression>
	</variable>
	<variable name="SQTY" class="java.lang.String">
		<variableExpression><![CDATA[($F{QTY}.intValue() > 1) ? " X "+$F{QTY}:""]]></variableExpression>
	</variable>
	<group name="ITMFLAG" keepTogether="true">
		<groupExpression><![CDATA[$F{ITMFLAG}]]></groupExpression>
		<groupFooter>
			<band height="15">
				<printWhenExpression><![CDATA[$F{ITMFLAG}.equals( "A" )]]></printWhenExpression>
				<textField isStretchWithOverflow="true">
					<reportElement x="365" y="0" width="90" height="12" isPrintWhenDetailOverflows="true"/>
					<textElement textAlignment="Right">
						<font fontName="Arial Unicode MS" size="8" isBold="true"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA[$F{ITMFLAG}.equals( "A" ) ? "Sub Total" : ""]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" isBlankWhenNull="true">
					<reportElement x="0" y="13" width="557" height="2" isRemoveLineWhenBlank="true" isPrintWhenDetailOverflows="true">
						<printWhenExpression><![CDATA[$P{ALINENOTES}.length()>0]]></printWhenExpression>
					</reportElement>
					<textElement>
						<font fontName="Arial Unicode MS" size="8"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA[$P{ALINENOTES}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" isBlankWhenNull="true">
					<reportElement x="0" y="12" width="558" height="1" isRemoveLineWhenBlank="true" isPrintWhenDetailOverflows="true">
						<printWhenExpression><![CDATA[$P{3LINESNOTE}.length()>0]]></printWhenExpression>
					</reportElement>
					<textElement>
						<font fontName="Arial Unicode MS" size="8"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA[$P{3LINESNOTE}]]></textFieldExpression>
				</textField>
				<textField pattern="###,###,###,##0.00" isBlankWhenNull="true">
					<reportElement x="455" y="0" width="100" height="12"/>
					<box>
						<rightPen lineWidth="0.0"/>
					</box>
					<textElement textAlignment="Right">
						<font fontName="Arial Unicode MS" size="8"/>
					</textElement>
					<textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{ITMFLAG}.equals( "A" ) ? $V{TOTAL}:null]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<group name="STNDATE">
		<groupExpression><![CDATA[$F{STNTDATE}]]></groupExpression>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<columnHeader>
		<band height="20" splitType="Stretch">
			<line>
				<reportElement x="0" y="19" width="555" height="1"/>
			</line>
			<textField>
				<reportElement x="0" y="4" width="100" height="15"/>
				<textElement markup="styled">
					<font fontName="Arial Unicode MS" size="8" isBold="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["Date <style fontName='Ming(for ISO10646_V3)'>" + $P{Date} + "</style>"]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="109" y="4" width="221" height="15"/>
				<textElement markup="styled">
					<font fontName="Arial Unicode MS" size="8" isBold="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["Item <style fontName='Ming(for ISO10646_V3)'>" + $P{Item} + "</style>"]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="455" y="4" width="100" height="15"/>
				<textElement textAlignment="Right" markup="styled">
					<font fontName="Arial Unicode MS" size="8" isBold="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["Amount <style fontName='Ming(for ISO10646_V3)'>" + $P{Amount} + "</style>"]]></textFieldExpression>
			</textField>
		</band>
	</columnHeader>
	<detail>
		<band height="13" splitType="Stretch">
			<printWhenExpression><![CDATA[$F{STNTDATE}.length()!=0]]></printWhenExpression>
			<textField pattern="###,###,###,##0.00" isBlankWhenNull="true">
				<reportElement x="455" y="0" width="100" height="12"/>
				<box rightPadding="0">
					<rightPen lineWidth="0.0"/>
				</box>
				<textElement textAlignment="Right">
					<font fontName="Arial Unicode MS" size="8"/>
				</textElement>
				<textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{AMOUNT}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement x="109" y="0" width="331" height="12" isPrintWhenDetailOverflows="true"/>
				<textElement markup="styled">
					<font fontName="Arial Unicode MS" size="8"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["<style fontName='Arial Unicode MS'>" + org.apache.commons.lang.StringEscapeUtils.escapeHtml($F{DESCRIPTION}) + "</style> <style fontName='Ming(for ISO10646_V3)'>" + $F{CDESCCODE} + "</style> <style fontName='Arial Unicode MS'>" + $V{SQTY} + "</style>"]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement isPrintRepeatedValues="false" x="0" y="0" width="100" height="12" printWhenGroupChanges="ITMFLAG"/>
				<textElement>
					<font fontName="Arial Unicode MS" size="8"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{STNTDATE}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
</jasperReport>
