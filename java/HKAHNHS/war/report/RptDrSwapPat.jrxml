<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="RptDrSwapPat" language="groovy" pageWidth="540" pageHeight="842" whenNoDataType="AllSectionsNoDetail" columnWidth="500" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20">
	<property name="ireport.zoom" value="1.6105100000000008"/>
	<property name="ireport.x" value="69"/>
	<property name="ireport.y" value="0"/>
	<parameter name="StartDate" class="java.lang.String"/>
	<parameter name="EndDate" class="java.lang.String"/>
	<parameter name="SteCode" class="java.lang.String"/>
	<parameter name="SteName" class="java.lang.String"/>
	<queryString>
		<![CDATA[SELECT distinct to_date($P{StartDate},'dd-mm-yyyy') as DATERANGESTART,
       to_date($P{EndDate}, 'dd-mm-yyyy') as DATERANGEEND,
       dh.patno,
       p.patfname,
       p.patgname,
       r.slpno,
       dh.dhsdate,
       dh.dhsedate,
       decode(trunc(dh.dhsedate) - trunc(dh.dhsdate),0,1,trunc(dh.dhsedate) - trunc(dh.dhsdate)) as CDay,
       dh.doccode,
       sc.stename,
       d.DocFName,
       d.DocGname
From   dochist dh,
       patient p,
       reg r,
       doctor d,
       site sc,
(select f.dhsid as fid,
        t.dhsid as tid
 From   dochist f,
        dochist t
 Where  f.dhsdate >= to_date($P{StartDate},'dd/mm/yyyy')
        and f.dhsdate < to_date($P{EndDate},'dd/mm/yyyy') + 1
        and f.dhsedate = t.dhsdate
        and f.regid = t.regid
        and t.dhssts = 'C') tmp
Where (dh.dhsid = tmp.fid or dh.dhsid = tmp.tid)
      AND r.stecode= $P{SteCode}
      AND r.stecode = sc.stecode
      AND dh.regid = r.regid
      AND dh.patno = p.patno
      AND dh.doccode = d.doccode
order by dh.patno]]>
	</queryString>
	<field name="DATERANGESTART" class="java.sql.Timestamp"/>
	<field name="DATERANGEEND" class="java.sql.Timestamp"/>
	<field name="PATNO" class="java.lang.String"/>
	<field name="PATFNAME" class="java.lang.String"/>
	<field name="PATGNAME" class="java.lang.String"/>
	<field name="SLPNO" class="java.lang.String"/>
	<field name="DHSDATE" class="java.sql.Timestamp"/>
	<field name="DHSEDATE" class="java.sql.Timestamp"/>
	<field name="CDAY" class="java.math.BigDecimal"/>
	<field name="DOCCODE" class="java.lang.String"/>
	<field name="STENAME" class="java.lang.String"/>
	<field name="DOCFNAME" class="java.lang.String"/>
	<field name="DOCGNAME" class="java.lang.String"/>
	<sortField name="PATNO"/>
	<sortField name="DHSEDATE"/>
	<variable name="PatientName" class="java.lang.String">
		<variableExpression><![CDATA[$F{PATFNAME} + " " + $F{PATGNAME}]]></variableExpression>
	</variable>
	<variable name="DoctorName" class="java.lang.String">
		<variableExpression><![CDATA[$F{DOCFNAME} + " " + $F{DOCGNAME}]]></variableExpression>
	</variable>
	<background>
		<band splitType="Stretch"/>
	</background>
	<pageHeader>
		<band height="16" splitType="Stretch">
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement x="385" y="0" width="80" height="16"/>
				<textElement textAlignment="Right">
					<font size="6"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["Page "+$V{PAGE_NUMBER}+" of"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" evaluationTime="Report" isBlankWhenNull="true">
				<reportElement x="465" y="0" width="35" height="16"/>
				<textElement>
					<font size="6"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
		</band>
	</pageHeader>
	<columnHeader>
		<band height="115" splitType="Stretch">
			<staticText>
				<reportElement x="4" y="0" width="55" height="12"/>
				<textElement verticalAlignment="Middle">
					<font size="6"/>
				</textElement>
				<text><![CDATA[rptDrSwapPat]]></text>
			</staticText>
			<staticText>
				<reportElement x="4" y="100" width="24" height="15"/>
				<textElement>
					<font size="6" isBold="true"/>
				</textElement>
				<text><![CDATA[Pat No.]]></text>
			</staticText>
			<staticText>
				<reportElement x="42" y="100" width="35" height="15"/>
				<textElement>
					<font size="6"/>
				</textElement>
				<text><![CDATA[PatientName]]></text>
			</staticText>
			<staticText>
				<reportElement x="180" y="100" width="22" height="15"/>
				<textElement>
					<font size="6"/>
				</textElement>
				<text><![CDATA[Slip No.]]></text>
			</staticText>
			<staticText>
				<reportElement x="224" y="84" width="30" height="30"/>
				<textElement>
					<font size="6"/>
				</textElement>
				<text><![CDATA[Start
Treatment
Date]]></text>
			</staticText>
			<staticText>
				<reportElement x="268" y="85" width="30" height="30"/>
				<textElement>
					<font size="6"/>
				</textElement>
				<text><![CDATA[End
Treatment
Date]]></text>
			</staticText>
			<staticText>
				<reportElement x="317" y="101" width="20" height="12"/>
				<textElement>
					<font size="6"/>
				</textElement>
				<text><![CDATA[Doctor]]></text>
			</staticText>
			<staticText>
				<reportElement x="460" y="101" width="12" height="12"/>
				<textElement>
					<font size="6"/>
				</textElement>
				<text><![CDATA[Day]]></text>
			</staticText>
			<staticText>
				<reportElement x="240" y="49" width="10" height="15"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="7"/>
				</textElement>
				<text><![CDATA[to]]></text>
			</staticText>
			<line>
				<reportElement x="4" y="108" width="22" height="1"/>
				<graphicElement>
					<pen lineWidth="0.75"/>
				</graphicElement>
			</line>
			<line>
				<reportElement x="42" y="109" width="35" height="1"/>
				<graphicElement>
					<pen lineWidth="0.75"/>
				</graphicElement>
			</line>
			<line>
				<reportElement x="180" y="108" width="22" height="1"/>
				<graphicElement>
					<pen lineWidth="0.75"/>
				</graphicElement>
			</line>
			<line>
				<reportElement x="224" y="92" width="14" height="1"/>
				<graphicElement>
					<pen lineWidth="0.75"/>
				</graphicElement>
			</line>
			<line>
				<reportElement x="224" y="100" width="28" height="1"/>
				<graphicElement>
					<pen lineWidth="0.75"/>
				</graphicElement>
			</line>
			<line>
				<reportElement x="224" y="108" width="12" height="1"/>
				<graphicElement>
					<pen lineWidth="0.75"/>
				</graphicElement>
			</line>
			<line>
				<reportElement x="268" y="101" width="28" height="1"/>
				<graphicElement>
					<pen lineWidth="0.75"/>
				</graphicElement>
			</line>
			<line>
				<reportElement x="268" y="109" width="14" height="1"/>
				<graphicElement>
					<pen lineWidth="0.75"/>
				</graphicElement>
			</line>
			<line>
				<reportElement x="268" y="92" width="12" height="1"/>
				<graphicElement>
					<pen lineWidth="0.75"/>
				</graphicElement>
			</line>
			<line>
				<reportElement x="317" y="108" width="18" height="1"/>
				<graphicElement>
					<pen lineWidth="0.75"/>
				</graphicElement>
			</line>
			<line>
				<reportElement x="460" y="109" width="12" height="1"/>
				<graphicElement>
					<pen lineWidth="0.75"/>
				</graphicElement>
			</line>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement x="200" y="50" width="40" height="15"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="6"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$P{StartDate}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement x="250" y="50" width="40" height="15"/>
				<textElement verticalAlignment="Middle">
					<font size="6"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$P{EndDate}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="dd/MM/yyyy HH:mm:ss" isBlankWhenNull="true">
				<reportElement x="4" y="11" width="100" height="12"/>
				<textElement verticalAlignment="Middle">
					<font size="6"/>
				</textElement>
				<textFieldExpression class="java.util.Date"><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="173" y="32" width="145" height="20"/>
				<textElement textAlignment="Center">
					<font size="6"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$P{SteName}+
"\nDoctor Swap History Report - By Patient"]]></textFieldExpression>
			</textField>
		</band>
	</columnHeader>
	<detail>
		<band height="16" splitType="Stretch">
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement isPrintRepeatedValues="false" x="4" y="0" width="35" height="16"/>
				<textElement verticalAlignment="Middle">
					<font size="6"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{PATNO}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement isPrintRepeatedValues="false" x="42" y="0" width="134" height="16"/>
				<textElement verticalAlignment="Middle">
					<font size="6"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$V{PatientName}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement isPrintRepeatedValues="false" x="180" y="0" width="40" height="16"/>
				<textElement verticalAlignment="Middle">
					<font size="6"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{SLPNO}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="dd/MM/yyyy" isBlankWhenNull="true">
				<reportElement x="224" y="0" width="40" height="16"/>
				<textElement verticalAlignment="Middle">
					<font size="6"/>
				</textElement>
				<textFieldExpression class="java.sql.Timestamp"><![CDATA[$F{DHSDATE}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="dd/MM/yyyy" isBlankWhenNull="true">
				<reportElement x="268" y="0" width="45" height="16"/>
				<textElement verticalAlignment="Middle">
					<font size="6"/>
				</textElement>
				<textFieldExpression class="java.sql.Timestamp"><![CDATA[$F{DHSEDATE}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement x="317" y="0" width="35" height="16"/>
				<textElement verticalAlignment="Middle">
					<font size="6"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{DOCCODE}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement x="356" y="0" width="100" height="16"/>
				<textElement verticalAlignment="Middle">
					<font size="6"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$V{DoctorName}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement x="460" y="0" width="40" height="16"/>
				<textElement verticalAlignment="Middle">
					<font size="6"/>
				</textElement>
				<textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{CDAY}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
</jasperReport>
