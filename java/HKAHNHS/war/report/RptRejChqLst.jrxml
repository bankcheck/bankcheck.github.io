<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="RptRejChqLst" pageWidth="595" pageHeight="842" whenNoDataType="AllSectionsNoDetail" columnWidth="561" leftMargin="17" rightMargin="17" topMargin="17" bottomMargin="0">
	<property name="ireport.zoom" value="1.5"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="StartDate" class="java.lang.String"/>
	<parameter name="EndDate" class="java.lang.String"/>
	<parameter name="siteName" class="java.lang.String"/>
	<queryString>
		<![CDATA[select * from (
                select
                 sp.slpno, sp.patno, sp.slptype,
                 nvl(pt.patfname,sp.slpfname) || ' ' || nvl(sp.slpgname, pt.patgname) as patname,
                  st.stnnamt, st.usrid,to_char(st.stncdate,'dd/mm/yyyy')stncdate

            from sliptx st, slip sp, patient pt, cashtx ct, sliptx st2
                     where (st.stncdate between to_date('01/01/2006', 'dd/mm/yyyy') and to_date('01/06/2006', 'dd/mm/yyyy') + 1 )
                             and st.itmcode = 'PAYME'
                             and st.slpno = sp.slpno
                             and sp.patno = pt.patno(+)
                             and sp.stecode =  'HKAH'
                             and st.stnxref = ct.ctxid
                             and ct.ctxmeth = 'Q'
                             and st.stnsts = 'U'
                             and st.stntype <>  'P'
                             and st.slpno = st2.slpno
                             and st.stnxref = st2.stnxref
                             and st.stntype = st2.stntype
                             and st2.STNSTS = 'C'
                             and trunc(st.stncdate) > trunc(st2.stncdate)
Union
                  select '' as slpno, '' as patno, '' as slptype, ct.ctxname || '-' || ct.ctxdesc as patname,
                              abs(ct.ctxamt) as stnnamt, c.usrid,
                             to_char(ct.ctxcdate,'dd/mm/yyyy') as stncdate
                       from cashtx ct, cashtx ct2 , cashier c
                       where(ct.ctxcdate between to_date('01/01/2006', 'dd/mm/yyyy') and to_date('01/06/2006', 'dd/mm/yyyy') + 1 )
                             and ct.slpno is null
                             and ct.ctxtype = 'R'
                             and ct.stecode =  'HKAH'
                             and ct.ctxmeth =  'Q'
                             and ct.ctxsts = 'R'
                             and ct.cshcode = c.cshcode
                             and ct.ctxsno = ct2.ctxsno
                             and ct.ctxtype = ct2.ctxtype
                             and ct2.ctxSTS = 'V'
                             and trunc(ct.ctxcdate) > trunc(ct2.ctxcdate))
   order by slptype,patno]]>
	</queryString>
	<field name="SLPNO" class="java.lang.String"/>
	<field name="PATNO" class="java.lang.String"/>
	<field name="SLPTYPE" class="java.lang.String"/>
	<field name="PATNAME" class="java.lang.String"/>
	<field name="STNNAMT" class="java.lang.String"/>
	<field name="USRID" class="java.lang.String"/>
	<field name="STNCDATE" class="java.lang.String"/>
	<variable name="STNNAMT_1" class="java.math.BigDecimal" resetType="Group" resetGroup="Group1_SlipType" calculation="Sum">
		<variableExpression><![CDATA[$V{STNNAMT_BD}]]></variableExpression>
	</variable>
	<variable name="STNNAMT_2" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$V{STNNAMT_BD}]]></variableExpression>
	</variable>
	<variable name="STNNAMT_BD" class="java.math.BigDecimal" resetType="None">
		<variableExpression><![CDATA[new BigDecimal($F{STNNAMT})]]></variableExpression>
	</variable>
	<filterExpression><![CDATA[$F{USRID}.length()>0]]></filterExpression>
	<group name="Group1_SlipType">
		<groupExpression><![CDATA[$F{SLPTYPE}]]></groupExpression>
		<groupHeader>
			<band height="40">
				<staticText>
					<reportElement x="0" y="0" width="70" height="20"/>
					<textElement verticalAlignment="Middle">
						<font fontName="Arial Unicode MS" isBold="true"/>
					</textElement>
					<text><![CDATA[Patient Type:]]></text>
				</staticText>
				<textField isBlankWhenNull="true">
					<reportElement x="70" y="0" width="100" height="20"/>
					<textElement verticalAlignment="Middle">
						<font fontName="Arial Unicode MS" isBold="true"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA[$F{SLPTYPE}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement x="0" y="20" width="70" height="20"/>
					<textElement verticalAlignment="Middle">
						<font fontName="Arial Unicode MS" isBold="true" isUnderline="true"/>
					</textElement>
					<text><![CDATA[Patient No]]></text>
				</staticText>
				<staticText>
					<reportElement x="70" y="20" width="68" height="20"/>
					<textElement verticalAlignment="Middle">
						<font fontName="Arial Unicode MS" isBold="true" isUnderline="true"/>
					</textElement>
					<text><![CDATA[Slip No]]></text>
				</staticText>
				<staticText>
					<reportElement x="380" y="20" width="56" height="20"/>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font fontName="Arial Unicode MS" isBold="true" isUnderline="true"/>
					</textElement>
					<text><![CDATA[Amount]]></text>
				</staticText>
				<staticText>
					<reportElement x="508" y="20" width="54" height="20"/>
					<textElement verticalAlignment="Middle">
						<font fontName="Arial Unicode MS" isBold="true" isUnderline="true"/>
					</textElement>
					<text><![CDATA[User ID]]></text>
				</staticText>
				<staticText>
					<reportElement x="446" y="20" width="62" height="20"/>
					<textElement verticalAlignment="Middle">
						<font fontName="Arial Unicode MS" isBold="true" isUnderline="true"/>
					</textElement>
					<text><![CDATA[Cap. Date]]></text>
				</staticText>
				<staticText>
					<reportElement x="138" y="20" width="242" height="20"/>
					<textElement verticalAlignment="Middle">
						<font fontName="Arial Unicode MS" isBold="true" isUnderline="true"/>
					</textElement>
					<text><![CDATA[Patient Name]]></text>
				</staticText>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="20">
				<staticText>
					<reportElement x="287" y="0" width="93" height="20"/>
					<textElement verticalAlignment="Middle">
						<font fontName="Arial Unicode MS" isBold="true"/>
					</textElement>
					<text><![CDATA[Patient Type Total:]]></text>
				</staticText>
				<textField evaluationTime="Group" evaluationGroup="Group1_SlipType" pattern="#,##0.00;-#,##0.00" isBlankWhenNull="true">
					<reportElement x="380" y="0" width="56" height="20"/>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font fontName="Arial Unicode MS" isBold="true"/>
					</textElement>
					<textFieldExpression class="java.math.BigDecimal"><![CDATA[$V{STNNAMT_1}]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<pageHeader>
		<band height="87" splitType="Stretch">
			<staticText>
				<reportElement x="0" y="33" width="561" height="17"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial Unicode MS" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Reject Cheque List]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="0" width="100" height="15"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial Unicode MS"/>
				</textElement>
				<text><![CDATA[rptRejChqLst]]></text>
			</staticText>
			<textField isBlankWhenNull="true">
				<reportElement x="0" y="49" width="561" height="17"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial Unicode MS" size="12" isBold="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$P{StartDate}+" - "+$P{EndDate}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="0" y="17" width="561" height="17"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial Unicode MS" size="12" isBold="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$P{siteName}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="441" y="72" width="80" height="15"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial Unicode MS" isBold="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["Page "+$V{PAGE_NUMBER}+" of"]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report">
				<reportElement x="521" y="72" width="40" height="15"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial Unicode MS" isBold="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
		</band>
	</pageHeader>
	<detail>
		<band height="20" splitType="Stretch">
			<textField isBlankWhenNull="true">
				<reportElement x="0" y="0" width="70" height="20"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial Unicode MS"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{PATNO}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="70" y="0" width="68" height="20"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial Unicode MS"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{SLPNO}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="138" y="0" width="242" height="20"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial Unicode MS"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{PATNAME}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00;-#,##0.00" isBlankWhenNull="true">
				<reportElement x="380" y="0" width="56" height="20"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial Unicode MS"/>
				</textElement>
				<textFieldExpression class="java.math.BigDecimal"><![CDATA[$V{STNNAMT_BD}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="446" y="0" width="62" height="20"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial Unicode MS"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{STNCDATE}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="508" y="0" width="53" height="20"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial Unicode MS"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{USRID}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<summary>
		<band height="20" splitType="Stretch">
			<staticText>
				<reportElement x="287" y="0" width="93" height="20"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial Unicode MS" isBold="true"/>
				</textElement>
				<text><![CDATA[Grand Total:]]></text>
			</staticText>
			<textField pattern="#,##0.00;-#,##0.00" isBlankWhenNull="true">
				<reportElement x="380" y="0" width="54" height="20"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial Unicode MS" isBold="true"/>
				</textElement>
				<textFieldExpression class="java.math.BigDecimal"><![CDATA[$V{STNNAMT_2}]]></textFieldExpression>
			</textField>
		</band>
	</summary>
</jasperReport>
